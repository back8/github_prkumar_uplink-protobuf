# [Uplink](https://github.com/prkumar/uplink) + [Protocol Buffers](https://github.com/google/protobuf) = [ðŸ’–](http://www.dictionary.com/browse/bliss)

Send and receive protobuf messages over HTTP, with ease.

## Installation

```
$ pip install uplink-protobuf
```

## Usage

### Receiving Protobuf Messages

For any `Consumer` method that is expecting a protobuf encoded response,
simply set the appropriate protobuf message type as the method's [return
value annotation](https://www.python.org/dev/peps/pep-3107/#return-values):

```python
from uplink import Consumer, get

# Import Python code generated by Google's protobuf compiler:
from addressbook_pb2.py import Person

class AddressBookClient(Consumer):
    @get("/persons/{person_id}")
    def get_person(self, id) -> Person:
        pass
```

Then when invoked, the annotated method will appropriately decode the
response into the specified message type:

```python
>>> addressbook_client = AddressBookClient(base_url=BASE_URL)
>>> addressbook_client.get_person(1234)
name: "Haley Arganbright"
id: 1234
email: "haley.arganbright@example.com"
phones {
  number: "555-4321"
  type: HOME
}
```

### Sending Protobuf Messages

For a `Consumer` method that needs to send a protobuf encoded request,
simply annotate the appropriate method argument with [`uplink.Body`](https://uplink.readthedocs.io/en/stable/quickstart.html#request-body):

```python
from uplink import Consumer, post, Body

# Import Python code generated by Google's protobuf compiler:
from addressbook_pb2.py import Person

class AddressBookClient(Consumer):
    @post("/persons")
    def create_person(self, person: Body(type=Person)):
        pass
```

Then when the method is invoked, the value of the annotated argument is
automatically encoded:

```python
# Register new person:
person = Person()
person.name = "Susie Morales"
person.id = 5678
person.email = "susie.morales@example.com"

# Send person to API:
addressbook_client = AddressBookClient(base_url=BASE_URL)
addressbook_client.create_person(person)
```


## FAQs

- **What is Protocol Buffers?**

    Checkout Google's official Protocol Buffers [Developer Guide](https://developers.google.com/protocol-buffers/docs/overview).

- **How do I install Google's protobuf compiler, `protoc`?**

   Checkout [this guide](http://google.github.io/proto-lens/installing-protoc.html) for installation instructions with Mac
   and Linux.

- **How do compile my `.proto` file using `protoc`?**

    Refer to [this section](https://developers.google.com/protocol-buffers/docs/reference/python-generated#invocation)
    in the offical Protocol Buffers Developer Guide.

- **What is Uplink?**

  It's a "Declarative HTTP Client". Checkout the library's [GitHub repo](https://github.com/prkumar/uplink)
  for more.
